{% extends 'base.html.twig' %}

{% block title %}Justice - Home{% endblock %}

{% block body %}

    {# === SECCIÓN 1: GALERÍA DE IMÁGENES === #}
    <div class="container-fluid py-5">
        <div class="container">
             <div class="text-center pb-2">
                <h6 class="text-uppercase">Our Works</h6>
                <h1 class="mb-4">Portfolio</h1>
             </div>
             
             {# Pestañas de categorías #}
             <div class="row">
                <div class="col-12 text-center mb-2">
                    {# CAMBIO 1: Quitamos el id="portfolio-flters" para que el JS de la plantilla no moleste #}
                    {# CAMBIO 2: Añadimos la clase 'nav nav-pills justify-content-center' #}
                    <ul class="nav nav-pills justify-content-center mb-4" id="mis-categorias-tabs" role="tablist">
                        {% for category in categories %}
                            <li class="nav-item">
                                {# CAMBIO 3: Usamos <a> con clase 'nav-link' y data-toggle="pill" #}
                                <a class="nav-link {{ loop.first ? 'active' : '' }}" 
                                   id="tab-category{{ category.id }}" 
                                   data-toggle="pill" 
                                   href="#category{{ category.id }}" 
                                   role="tab" 
                                   aria-controls="category{{ category.id }}" 
                                   aria-selected="{{ loop.first ? 'true' : 'false' }}">
                                    {{ category.name }}
                                </a>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>

            {# Contenedor de Imágenes #}
            <div class="tab-content">
                {% for category in categories %}
                    <div id="category{{ category.id }}" class="tab-pane fade {{ loop.first ? 'show active' : '' }}">
                        <div class="row">
                            {% for image in category.images %}
                                {# Carga el partial que creaste #}
                                {{ include ('partials/_image.html.twig') }}
                            {% else %}
                                <div class="col-12 text-center">
                                    <p>No hay imágenes en esta categoría.</p>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                {% else %}
                    <div class="col-12 text-center">
                        <p>No hay categorías creadas. Ve al panel de admin para crear alguna.</p>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>

    {# === SECCIÓN 2: LISTA DE CONTACTOS (Solo visible si estás logueado) === #}
    {% if app.user %} 
        <div class="container py-5 border-top">
            <div class="row">
                <div class="col-12">
                    <h3 class="mb-4">Admin: Mensajes de Contacto</h3>
                    <table class="table table-bordered table-hover">
                        <thead class="thead-light">
                            <tr>
                                <th>Nombre</th>
                                <th>Email</th>
                                <th>Asunto</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for contact in contacts %}
                                <tr>
                                    <td>{{ contact.firstName }} {{ contact.lastName }}</td>
                                    <td>{{ contact.email }}</td>
                                    <td>{{ contact.subject }}</td>
                                    <td>
                                        <a href="{{ path('contact_edit', {'id': contact.id}) }}" class="btn btn-sm btn-warning">Editar</a>
                                    </td>
                                </tr>
                            {% else %}
                                <tr><td colspan="4">No hay mensajes de contacto.</td></tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    {% endif %}

{% endblock %}